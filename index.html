<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Git Training</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reset.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reveal.min.css" type="text/css">
    <link rel="stylesheet" href="./css/horizon.css" type="text/css">
    
    <!-- Load scripts in head -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/plugin/math/math.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/plugin/notes/notes.min.js"></script>
    <script src="https://kit.fontawesome.com/b0b226af51.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <!-- Title Slide -->
        <section data-background-color="#16161c">
          <div class="titlebox">
            <h1 class="title"><i class="logo fa-brands fa-git-alt"></i> git</h1>
          </div>
        </section>
        <section data-background-image="./img/goongit.gif">
          <aside class="notes">
            Talk about how they should open the tool of their choice, the supporting material you gave out,
            that they are the guinea pigs and that feedback forms will be emailed out following the course.
          </aside>
        </section>


        <!-- DESCRIPTION -->
        <section>
          <section>
            <h1>About me</h1>
            <h2>üßîüèº</h2>
          </section>
          <section>
            <div class="twincol">
              <div class="col" style="padding-top:15px;">
                <img class="avatar" src="./img/avatar.png" alt="Profile picture of Gareth Clews" />
              </div>

              <div class="col">
                <ul>
                  <li>@DBT < 1 year</li>
                  <li>Mathematician</li>
                  <li>Programming: decades</li>
                  <li>Data Scientist: 8 years</li>
                  <li>Version control: 2007</li>
                  <li>PGCHE</li>
                  <li>Training since 2010</li>
                </ul>
              </div>
            </div>
          </section>
        </section>

        <section>
          <section data-background-color="#16161c"><h1>About this course</h1></section>
          <section>
            <h3>Learning Objectives</h3>
            <ul>
              <li>Understand Git fundamentals and internal mechanics</li>
              <li>Learn workflow strategies and when to use them</li>
              <li>Practice solving common Git problems</li>
              <li>Develop skills through hands-on exercises</li>
            </ul>
          </section>
          <section>
            <h3>Learning Outcomes</h3>
            <ul>
              <li>Implement git workflow strategies</li>
              <li>Resolve merge conflicts systematically</li>
              <li>Create and manage feature branches effectively</li>
              <li>Write descriptive commit messages and pull requests</li>
            </ul>
          </section>
        </section>


        <!-- INTRODUCTION -->
        <section>
          <section data-background-color="#16161c"><h1>Introduction</h1></section>
          <section>
            <h1>What is version control?</h1>
            <h4>Definition</h4>
            <p>A system which records changes to files over time.</p>

            <h4>Benefits</h4>
            <ul>
              <li>History tracking and documentation</li>
              <li>Collaboration facilitation</li>
              <li>Experimentation without risk</li>
              <li>Accountability and governance</li>
            </ul>
          </section>

          <section>
            <h4>Life before version control</h4>
            <ul>
              <li class="fragment">final.doc</li>
              <li class="fragment">final_v2.doc</li>
              <li class="fragment">final_v2_comments.doc</li>
              <li class="fragment">final_FINAL.doc</li>
            </ul>
          </section>

          <section>
            <h4>Evolution of version control</h4>

            <ul>
              <li class="fragment">Local (rsync)</li>
              <li class="fragment">Centralised (CVS, subversion)</li>
              <li class="fragment">Distributed (git, mercurial)</li>
            </ul>
          </section>

          <section>
            <h2>About git</h2>

            <ul>
              <li>Introduced in 2005 for linux kernel development</li>
              <li>Priorises:</li>
              <ul>
                <li>Speed</li>
                <li>Data integrity</li>
                <li>Distributed workflows</li>
                <li>Branching capabilities</li>
              </ul>
            </ul>
          </section>

          <section>
            <h4>Key terminology</h4>

            <ul>
              <li class="fragment"><strong>Repository</strong>: project storage location</li>
              <li class="fragment"><strong>Commit</strong>: a snapshot of changes</li>
              <li class="fragment"><strong>Branch</strong>: an independent line of development</li>
              <li class="fragment"><strong>Staging area</strong>: preparation space for commits</li>
              <li class="fragment"><strong>Remote</strong>: external repository location</li>
              <li class="fragment"><strong>Clone</strong>: to copy a repository</li>
              <li class="fragment"><strong>Working directory</strong>: the current files you can see and edit</li>
            </ul>
          </section>

          <section>
            <h3>Git object model</h3>
            <h4>Commits</h4>
            <ul>
              <li class="fragment">Contains metadata like author and commit message</li>
              <li class="fragment">Points to a parent commit (creating a history chain)</li>
              <li class="fragment">Points to a root tree representing project state</li>
            </ul>
          </section>

          <section>
            <h3>Git object model</h3>
            <h4>Trees</h4>

            <ul>
              <li class="fragment">Represent directories in your project</li>
              <li class="fragment">Contains references to blobs and other trees</li>
              <li class="fragment">Each entry has a name, type and hash pointer</li>
            </ul>
          </section>


          <section>
            <h3>Git object model</h3>
            <h4>Blobs</h4>

            <ul>
              <li class="fragment">Store the actual file contents</li>
              <li class="fragment">Immutable snapshots of file data</li>
              <li class="fragment">Each file has a hash associated</li>
            </ul>

            <aside class="notes">
              This hierarchical structure forms Git's content-addressable filesystem,
              where each object is identified by the SHA-1 hash of its content.
            </aside>

          </section>

          <section>
            <h3>Git object model</h3>
            <h4>Tags</h4>

            <ul>
              <li class="fragment">Permanent references to specific commits</li>
              <li class="fragment">Two different types available</li>
              <li class="fragment">Easily shared between repositories</li>
            </ul>


            <aside class="notes">
              <ul>
                <li><strong>Permanent references</strong>
                  that point to specific commits, unlike branches which move with new commits,
                  providing stable markers for important points in history (like releases)
                </li>
                <li><strong>Two types available</strong>
                  lightweight tags (simple pointers to commits) and annotated tags
                  (full Git objects with tagger name, email, date, message, and optional GPG signature)
                </li>
                <li><strong>Easily shared</strong>:
                  between repositories using `git push --tags`, allowing collaborators to reference
                  the same significant project milestones
                </li>
              </ul>
            </aside>

          </section>

          <section>
            <h3>Anatomy of a git</h3>
            <div class="container">
              <div class="directory">
                <div class="root">.git/</div>
                <div class="item">
                  <span class="file">HEAD&nbsp;&nbsp;&nbsp;&nbsp;</span>
                  <span class="comment"># Points to current branch</span>
                </div>
                <div class="item">
                  <span class="file">config&nbsp;&nbsp;</span>
                  <span class="comment"># Repository configuration</span>
                </div>
                <div class="item">
                  <span class="folder">hooks/&nbsp;&nbsp;</span>
                  <span class="comment"># Event scripts</span>
                </div>
                <div class="item">
                  <span class="folder">objects/</span>
                  <span class="comment"># All Git objects</span>
                </div>
                <div class="item">
                  <span class="folder">refs/&nbsp;&nbsp;&nbsp;</span>
                  <span class="comment"># Branch pointers</span>
                </div>
                <div class="item">
                  <span class="file">index&nbsp;&nbsp;&nbsp;</span>
                  <span class="comment"># Staging area</span>
                </div>
              </div>
            </div>
          </section>

          <section>
            <h3>Criticisms</h3>

            <ul>
              <li class="fragment">Steep learning curve</li>
              <li class="fragment">Inconsistent command syntax</li>
              <li class="fragment">Terminology confusion</li>
              <li class="fragment">Complex error messages</li>
              <li class="fragment">Command line focus</li>
              <li class="fragment">Mutable history</li>
            </ul>
          </section>

          <section>
            <h3>So why are we here?</h3>

            <ul>
              <li>Ubiquitous</li>
              <li>Powerful branching and merging</li>
              <li>Works offline</li>
              <li>Speed and efficiency*</li>
              <li>Scales well</li>
              <li>Rich ecosystem and tooling</li>
            </ul>
          </section>
        </section>

        <!--  BASICS -->
        <section>
          <section data-background-color="#16161c"><h1>Basics</h1></section>

          <section>
            <h2>The jump off</h2>

            <ul>
              <li>Designed to make sure we all start at the same point</li>
              <li>What is elementary for some is not for others</li>
            </ul>
          </section>

          <section>
            <h3>Creating a repository</h3>

            <pre>
              <code data-line-numbers data-trim>
                # create a directory for working in
                git init scia-git

                # clone these slides and the training content alongside
                # this will move before the training content is finalised
                git clone git@gitlab.data.trade.gov.uk:gareth.clews/git-training
              </code>
            </pre>
          </section>

          <section>
            <h3>Basic workflow</h3>

            <ol>
              <li>Modify the files in working directory</li>
              <li>Stage the changes with <span class="mono">git add</span></li>
              <li>Commit changes with <span class="mono">git commit</span></li>
              <li>Repeat!</li>
            </ol>
          </section>

          <section>
            <h3>Tracking changes</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="7">
                pushd scia-git
                touch README.md

                # check status
                git status

                # stage changes
                git add README.md
                # or (far more dangerous) stage all changes
                git add -- .  # newer version than `git add *`
              </code>
            </pre>
          </section>

          <section>
            <h3>Tracking changes</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="17">
                # commit changes
                git commit -m "Add a README"

                # or, stage tracked files and commit
                git commit -am "Added a README"

                # reset back to previous directory placement
                popd
              </code>
            </pre>
          </section>

          <section>
            <h3>Viewing histories</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="25">
                # view the commit history in different ways, choose one or try them all
                git log
                git log --oneline
                git log --graph --oneline --all
                git show HEAD # insert a hash (7 chars) from the above here
              </code>
            </pre>

          </section>

          <section>
            <h1>Exercise</h1>

            <ol>
              <li>Initialise a new repository for this course content</li>
              <li>Create and stage some files</li>
              <li>Make some commits with changes in between</li>
              <li>View your commit history</li>
              <li>Modify a file, commit again and view the history</li>
            </ol>

            <aside class="notes">
              This exercise is really to just do a couple of simple things. First is to get everybody to have
              a directory created with a git init, second is to make sure all the DW instances work fine and
              you're happy interfacing with a terminal in your preferred choice.
            </aside>
          </section>
        </section>


        <!-- STRATEGIES -->
        <section>
          <section data-background-color="#16161c"><h1>Strategies</h1></section>

          <section>
            <h2>Working smarter</h2>

            <ul>
              <li>Biggest conflict creator is not having a strategy</li>
              <li>We will cover two different approaches to working with git</li>
              <li>This is not an exhaustive list, but you should pick one</li>
            </ul>
          </section>

          <section>
            <h1>Trunk based development</h1>
          </section>

          <section>
            <img src="./img/trunk-based.svg" alt="Diagram of trunk-based development">
          </section>

          <section>
            <h3>Trunk based development</h3>
            <ul>
              <li>Keep branches small and short-lived</li>
              <li>Merge frequently to main</li>
              <li>Deploy from main</li>
              <li>Use feature flags for incomplete features</li>
              <li>Automated testing becomes crucial</li>
            </ul>
          </section>

          <section>
            <h3>Pros</h3>

            <ul>
              <li>Reduces merge complexity</li>
              <li>Facilitates continuous integration</li>
              <li>Simpler workflow</li>
              <li>Less context switching</li>
            </ul>
          </section>

          <section>
            <h3>Cons</h3>

            <ul>
              <li>Requires discipline</li>
              <li>Needs strong automated testing</li>
              <li>May be challenging if the features are larger</li>
              <li>Less formal release process</li>
            </ul>
          </section>


          <section>
            <h1>Git Flow Strategy</h1>
          </section>

          <section>
            <img src="./img/flow-based.svg" alt="Diagram of trunk-based development">

            <aside class="notes">

              <p>This is far more complicated looking. This shows:</p>

              <p>
              1. **Two Main Branches**:
                <ul>
                  <li> **Main/Master branch** (dark blue at top): Contains production-ready code</li>
                  <li>**Develop branch** (green below it): Integration branch for ongoing development</li>
                </ul>
              </p>
              <p>
              2. **Supporting Branches**:
              <ul>
                <li>**Feature branches** (purple): Branch off from develop and merge back into develop</li>
                <li>Shown as short curves above the develop branch</li>
                <li>Examples: feature/login and feature/search</li>
              </ul>

              <ul>
                <li>**Release branch** (orange): Branch off from develop and merge into both main and develop</li>
                <li>Created when develop has enough features for a release</li>
                <li>Used for final testing and bug fixes before production</li>
                <li>Example: release</li>
              </ul>

              <ul>
                <li>**Hotfix branch** (red): Branch directly off main for critical production fixes</li>
                <li>Merges back to both main and develop</li>
                <li>Example: hotfix/bug-123</li>
              </ul>
              </p>
              <p>
              3. **Version Tags**:
                <ul>
                  <li> Tags on main branch: v1.0, v1.1, v2.0, v2.1</li>
                  <li> Each represents a stable production release</li>
                </ul>
              </p>

             <p>
              4. **Deployment Flow**:
               <ul>
                 <li>Dotted lines from main branch down to deployment environments</li>
                 <li>Production versions corresponding to each tagged release</li>
               </ul>
             </p>

             <p>
              Unlike trunk-based development, Git Flow has more structured branching
              patterns and is designed for scheduled releases rather than continuous delivery.
             </p>
            </aside>
          </section>

          <section>
            <h3>Git Flow Strategy</h3>
            <ul>
              <li>Multiple long-lived branches</li>
              <li>Structured release process</li>
              <li>Formalised branch naming</li>
            </ul>
          </section>

          <section>
            <h3>Naming branches</h3>

            <ul>
              <li class="fragment"><strong>main</strong>: production code</li>
              <li class="fragment"><strong>develop</strong>: integration branch</li>
              <li class="fragment"><strong>feature/*</strong>: new development</li>
              <li class="fragment"><strong>release/*</strong>: release preparation</li>
              <li class="fragment"><strong>hotfix/*</strong>: production fixes</li>
            </ul>
          </section>

          <section>
            <h3>Lifecycle</h3>

            <ol>
              <li class="fragment">Feature developed on feature branch</li>
              <li class="fragment">Feature merged to develop</li>
              <li class="fragment">Release branch created from develop</li>
              <li class="fragment">Release branch merged to main and develop</li>
              <li class="fragment">Hotfixes applied directly to main and develop</li>
            </ol>
          </section>

          <section>
            <h3>Pros</h3>

            <ul>
              <li>Clear separation of work</li>
              <li>Structured release process</li>
              <li>Good for versioned software</li>
              <li>Clear history visualisation</li>
            </ul>
          </section>

          <section>
            <h3>Cons</h3>

            <ul>
              <li>Complex with many branches</li>
              <li>Potential for long-lived branches</li>
              <li>Can encourage delayed integration</li>
              <li>Overhead is larger for simpler projects</li>
            </ul>
          </section>

          <section><h1>Choosing the right workflow</h1></section>

          <section>
            <h3>By team size</h3>

            <ul>
              <li>Smaller teams ‚Üí simpler workflows</li>
              <li>Larger teams ‚Üí more structure</li>
            </ul>
          </section>

          <section>
            <h3>By release frequency</h3>

            <ul>
              <li>Continuous delivery ‚Üí trunk-based</li>
              <li>Releases ‚Üí Git Flow</li>
            </ul>
          </section>

          <section>
            <h3>By project type</h3>

            <ul>
              <li>Web application ‚Üí trunk-based</li>
              <li>Versioned product ‚Üí Git Flow</li>
            </ul>

            <aside class="notes">
              This means that for the majority of tasks in DBT which are not web applications that Git Flow should be used.
            </aside>
          </section>

        </section>


        <!-- CASE STUDY -->
        <section>
          <section data-background-color="#16161c"><h1>Case study</h1></section>

          <section>
            <h2>Description</h2>
            <p>
              You're on a data science team and have to build a predictive model to forecast equipment failures.
              The goal is to deploy this as a web service for factory engineers.
            </p>
          </section>

          <section>
            <h2>Project team</h2>
            <ul>
              <li>3 Data Scientists</li>
              <li>1 ML Engineer</li>
              <li>2 Backend Developers</li>
              <li>1 DevOps Engineer</li>
            </ul>
          </section>

          <section>
            <h2>Project phases</h2>
            <ol>
              <li>Exploration & prototyping</li>
              <li>Model development & evaluation</li>
              <li>Integration with back end API</li>
              <li>Deployment & monitoring</li>
              <li>Iterative improvements</li>
            </ol>
          </section>

          <section>
            <h3>Pick a strategy</h3>
            <p><strong>Trunk-based development</strong> or <strong>Git Flow</strong>?</p>
          </section>
        </section>


        <section>
          <section data-background-color="#16161c"><h1>Resolving conflict</h1></section>

          <section>
            <h3>Branches</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="30">
                # get back to it
                pushd scia-training

                # list current branches
                git branch

                # create a branch
                git branch feature-login

                # switch to a branch
                git switch feature-login
                # older versions of git use `checkout` not `switch`
              </code>
            </pre>
          </section>

          <section>
            <h3>Branches</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="42">
                # create and switch in one command!
                git switch -c feature-login

                # delete a branch
                git switch main
                git branch -D feature-login

                popd
              </code>
            </pre>
          </section>

          <section>
            <h3>Merging</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="50">
                # -- SETUP --
                # recreate the other branch after we previously deleted it
                git switch -c feature-login

                # add a change, then commit it
                touch CONTRIBUTING.md
                git add CONTRIBUTING.md
                git commit -m "doc: add contributing guidelines"
              </code>
            </pre>
          </section>

          <section>
            <h3>Merging</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="58">
                # switch to the *target* branch
                git switch main

                # merge the branch
                git merge feature-login

                # housekeeping: delete the branch after successful merge
                git branch -d feature-login
              </code>
            </pre>
          </section>

          <section>
            <h3>Conflict resolution</h3>

            <p>When git cannot automatically merge files for you:</p>

            <ol>
              <li>Git marks conflicts in files</li>
              <li>Manually edit the files to resolve</li>
              <li>Stage resolved files (<span class="mono">git add</span>)</li>
              <li>Complete the merge (<span class="mono">git commit</span>)</li>
            </ol>
          </section>

          <section>
            <h1>Exercise</h1>

            <aside class="notes">If you can't think of what to do for each step, there are example changes in the
               exercise handout, please use those.</aside>

            <ol>
              <li>Create a feature branch</li>
              <li>Make changes on the feature branch, and commit them</li>
              <li>Switch back to main and make different changes, and commit them</li>
              <li>Merge the feature branch</li>
              <li>Resolve any conflicts</li>
            </ol>
          </section>
        </section>

        <section>
          <section data-background-color="#16161c"><h1>Troubleshooting</h1></section>

          <section>
            <h3>Divergent histories</h3>

            <ul>
              <li>Local and remote histories have different commits</li>
              <li>Common when multiple developers work on same branch</li>
              <li>Occurs after pulling with local commits</li>
            </ul>
          </section>

          <section>
            <h3>Divergent histories</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="66">
                # Option 1: merge remote changes with local merge commit
                git pull

                # Option 2: rebase local changes on top of remote
                git pull --rebase

                # Option 3: manual approach
                git fetch
                git rebase origin/main
                # or merge if you prefer that to rebase
                git fetch
                git merge origin/main
                # I won't go into this but there's a description in the supporting content
              </code>
            </pre>
          </section>

          <section>
            <h2>Example</h2>
            <aside class="notes">This will be a walkthrough example in emacs, the setup will be complex but I'll make it work.</aside>
          </section>


          <section>
            <h3>Detached HEAD</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="79">
                # how you got to this point
                git checkout HEAD~1  # any commit will do

                # you've accidentally checked out a commit and not a branch
                # Option 1: create a new branch to retain commits
                git switch -c new-branch-name

                # Option 2: abort, go back to where you were
                git switch -
              </code>
            </pre>
          </section>

          <section>
            <h3>Undoing changes</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="88">
                # Unstage a file
                git restore --staged file.txt

                # discard working directory changes
                git restore file.txt

                # undo last commit (keep changes staged)
                git reset --soft HEAD~1

                # undo last commit (discarding changes)
                git reset --hard HEAD~1

                # create new "undo" commit
                git revert HEAD
              </code>
            </pre>
          </section>

          <section>
            <h3>Handling stashes</h3>

            <pre>
              <code data-trim data-line-numbers data-ln-start-from="102">
                # Save work in progress
                git stash

                # List stashes
                git stash list

                # Apply the most recent stash
                git stash apply

                # Apply a specific stash
                git stash apply stash@{2}

                # Apply and remove stash
                git stash pop
              </code>
            </pre>
          </section>

          <section>
            <h1>Exercise</h1>

            <ol>
              <li>Resolve a merge conflict</li>
              <li>Recover from detached HEAD</li>
              <li>Stash changes and apply elsewhere</li>
              <li>Fix a divergent history with rebase</li>
            </ol>
          </section>
        </section>

        <section>
          <section data-background-color="#16161c"><h1>What next?</h1></section>

          <section>
            <h3>Advanced topics</h3>

            <ul>
              <li><strong>Hooks</strong>: automated scripts triggered by events</li>
              <li><strong>Submodules</strong>: repositories within repositories</li>
              <li><strong>LFS</strong>: Large File Storage for binary files</li>
              <li><strong>Bisect</strong>: binary search through the history to find bugs</li>
              <li><strong>Worktrees</strong>: multiple working directories for one repo</li>
            </ul>
          </section>

          <section>
            <h3>Homework</h3>

            <ul>
              <li><strong>Basic</strong>: repository setup and branch management</li>
              <li><strong>Intermediate</strong>: collaborative workflows and time travel</li>
              <li><strong>Advanced</strong>: rebasing workshop and git internals</li>
            </ul>

            <p>Detailed instructions in handout</p>
          </section>

          <section>
            <h3>Additional resources</h3>

            <ul>
              <li><a href="https://git-scm.com/doc">Official git documentation</a></li>
              <li><a href="https://git-scm.com/book">Pro git book</a> (free online)</li>
              <li><a href="https://education.github.com/git-cheat-sheet-education.pdf">Cheat sheet</a></li>
              <li><a href="https://learngitbranching.js.org">Interactive branching tutorial</a></li>
              <li><a href="https://ohshitgit.com">Oh Shit, Git!?!</a> (practical recovery tips)</li>
            </ul>
          </section>
        </section>

        <section>
          <section data-background-color="#16161c"><h1>Conclusion</h1></section>

          <section>
            <ul>
              <li>Git is powerful but requires practice and planning</li>
              <li>Choose workflows that match your team and project</li>
              <li>Problem-solving skills come with experience</li>
              <li>Continue your learning</li>
            </ul>
          </section>

          <section>
            <h1>Q&A</h1>
          </section>
        </section>


        <!-- CLOSING INFO -->
      </div>
    </div>
 
    <link rel="stylesheet" href="./css/horizon.hl.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/plugin/highlight/highlight.min.js"></script>
    <script>
      Reveal.initialize({ 
        plugins: [RevealMath.KaTeX, RevealNotes, RevealHighlight],
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'fade',
      });
    </script>
  </body>
</html>
